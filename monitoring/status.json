{
  "timestamp": "2026-02-19T22:47:00Z",
  "pipeline_run": "local",
  "branch": "main",
  "commit": "8200e27",
  "total_checks": 12,
  "status": "warning",
  "duration_seconds": 38,
  "checks": [
    {
      "number": 1,
      "name": "TruffleHog / Gitleaks",
      "tool": "gitleaks",
      "tool_version": "8.24.3",
      "owasp_id": "A07:2021",
      "cwe": "CWE-798",
      "status": "warning",
      "findings": 1,
      "details": [
        {
          "rule": "generic-api-key",
          "file": "skills/docker-hardening-auditor/evals/evals.json",
          "line": 34,
          "secret": "msk-live-abc123",
          "entropy": 3.664,
          "note": "Demo material â€” intentional test fixture"
        }
      ]
    },
    {
      "number": 2,
      "name": "Secret Grep (manual)",
      "tool": "grep",
      "tool_version": "ripgrep",
      "owasp_id": "A07:2021",
      "cwe": "CWE-798",
      "status": "passed",
      "findings": 0,
      "details": "No hardcoded secrets found in production Python files (excluding vulnerable_app/)"
    },
    {
      "number": 3,
      "name": "Bandit (Python SAST)",
      "tool": "bandit",
      "tool_version": "1.9.3",
      "owasp_id": "A03:2021",
      "cwe": "CWE-89,CWE-78,CWE-502,CWE-94",
      "status": "warning",
      "findings": 6,
      "severity_breakdown": {
        "high": 2,
        "medium": 4,
        "low": 9
      },
      "details": [
        {"id": "B608", "severity": "MEDIUM", "cwe": "CWE-89", "file": "vulnerable_app/app.py", "line": 40, "description": "SQL injection via string formatting"},
        {"id": "B602", "severity": "HIGH", "cwe": "CWE-78", "file": "vulnerable_app/app.py", "line": 56, "description": "subprocess call with shell=True"},
        {"id": "B301", "severity": "MEDIUM", "cwe": "CWE-502", "file": "vulnerable_app/app.py", "line": 70, "description": "Insecure deserialization with pickle.loads"},
        {"id": "B310", "severity": "MEDIUM", "cwe": "CWE-22", "file": "vulnerable_app/app.py", "line": 93, "description": "Unvalidated URL in urlopen (SSRF)"},
        {"id": "B201", "severity": "HIGH", "cwe": "CWE-94", "file": "vulnerable_app/app.py", "line": 134, "description": "Flask debug=True exposes Werkzeug debugger"},
        {"id": "B104", "severity": "MEDIUM", "cwe": "CWE-605", "file": "vulnerable_app/app.py", "line": 134, "description": "Binding to all interfaces 0.0.0.0"}
      ]
    },
    {
      "number": 4,
      "name": "Semgrep (multi-language SAST)",
      "tool": "semgrep",
      "tool_version": "1.152.0",
      "owasp_id": "A03:2021",
      "cwe": "CWE-89,CWE-78,CWE-502,CWE-918,CWE-22",
      "status": "warning",
      "findings": 15,
      "rules_run": 291,
      "targets_scanned": 3,
      "details": [
        {"rule": "tainted-sql-string", "file": "vulnerable_app/app.py", "line": 40, "severity": "blocking"},
        {"rule": "formatted-sql-query", "file": "vulnerable_app/app.py", "line": 41, "severity": "blocking"},
        {"rule": "sqlalchemy-execute-raw-query", "file": "vulnerable_app/app.py", "line": 41, "severity": "blocking"},
        {"rule": "subprocess-injection", "file": "vulnerable_app/app.py", "line": 54, "severity": "blocking"},
        {"rule": "dangerous-subprocess-use", "file": "vulnerable_app/app.py", "line": 55, "severity": "blocking"},
        {"rule": "subprocess-shell-true", "file": "vulnerable_app/app.py", "line": 56, "severity": "blocking"},
        {"rule": "insecure-deserialization", "file": "vulnerable_app/app.py", "line": 70, "severity": "blocking"},
        {"rule": "avoid-pickle", "file": "vulnerable_app/app.py", "line": 70, "severity": "blocking"},
        {"rule": "path-traversal-open", "file": "vulnerable_app/app.py", "line": 80, "severity": "blocking"},
        {"rule": "ssrf-injection-urllib", "file": "vulnerable_app/app.py", "line": 91, "severity": "blocking"},
        {"rule": "dynamic-urllib-use-detected", "file": "vulnerable_app/app.py", "line": 93, "severity": "blocking"},
        {"rule": "avoid_app_run_with_bad_host", "file": "vulnerable_app/app.py", "line": 134, "severity": "blocking"},
        {"rule": "debug-enabled", "file": "vulnerable_app/app.py", "line": 134, "severity": "blocking"},
        {"rule": "ssrf-injection-urllib", "file": "vulnerable_app/app_secure.py", "line": 150, "severity": "blocking"},
        {"rule": "dynamic-urllib-use-detected", "file": "vulnerable_app/app_secure.py", "line": 166, "severity": "blocking"}
      ]
    },
    {
      "number": 5,
      "name": "Dependency Audit (Safety + pip-audit)",
      "tool": "safety",
      "tool_version": "3.7.0",
      "secondary_tool": "pip-audit 2.9.0",
      "owasp_id": "A06:2021",
      "cwe": "CWE-1035",
      "status": "warning",
      "findings": 1,
      "details": [
        {
          "package": "gunicorn",
          "installed_version": "22.0.0",
          "vulnerability_id": "PVE-2024-72809",
          "affected_spec": ">=22.0.0,<23.0.0",
          "advisory": "TolerateDangerousFraming setting processes conflicting headers",
          "source": "safety",
          "pip_audit_result": "No known vulnerabilities found (OSV database)"
        }
      ]
    },
    {
      "number": 6,
      "name": "Trivy (container + filesystem CVEs)",
      "tool": "trivy",
      "tool_version": "0.59.1",
      "owasp_id": "A06:2021",
      "cwe": "CWE-1035",
      "status": "passed",
      "findings": 0,
      "details": "No HIGH/CRITICAL vulnerabilities in Python dependencies (filesystem scan)"
    },
    {
      "number": 7,
      "name": "Hadolint (Dockerfile lint)",
      "tool": "hadolint",
      "tool_version": "2.12.0",
      "owasp_id": "A05:2021",
      "cwe": "CWE-16",
      "status": "warning",
      "findings": 2,
      "details": [
        {"rule": "DL3008", "file": "docker/openclaw/Dockerfile", "line": 20, "severity": "warning", "description": "Pin versions in apt-get install (builder stage)"},
        {"rule": "DL3008", "file": "docker/openclaw/Dockerfile", "line": 45, "severity": "warning", "description": "Pin versions in apt-get install (runtime stage)"}
      ],
      "clean_files": ["docker/app/Dockerfile"]
    },
    {
      "number": 8,
      "name": "tfsec (Terraform security)",
      "tool": "trivy",
      "tool_version": "0.59.1",
      "owasp_id": "A05:2021",
      "cwe": "CWE-16",
      "status": "failed",
      "findings": 3,
      "details": [
        {"id": "AVD-AWS-0104", "severity": "CRITICAL", "file": "terraform/modules/vpc/main.tf", "line": 83, "description": "Security group vpn_hub allows unrestricted egress (0.0.0.0/0)"},
        {"id": "AVD-AWS-0104", "severity": "CRITICAL", "file": "terraform/modules/vpc/main.tf", "line": 130, "description": "Security group agent allows unrestricted egress (0.0.0.0/0)"},
        {"id": "AVD-AWS-0164", "severity": "HIGH", "file": "terraform/modules/vpc/main.tf", "line": 20, "description": "Subnet associates public IP address (map_public_ip_on_launch)"}
      ]
    },
    {
      "number": 9,
      "name": "Checkov (IaC compliance)",
      "tool": "checkov",
      "tool_version": "checkov-action@master",
      "owasp_id": "A05:2021",
      "cwe": "CWE-16",
      "status": "skipped",
      "findings": 0,
      "details": "Checkov runs in CI only (GitHub Actions). tfsec/trivy covered IaC misconfigs locally."
    },
    {
      "number": 10,
      "name": "License Audit",
      "tool": "pip-licenses",
      "tool_version": "5.5.1",
      "owasp_id": null,
      "cwe": null,
      "status": "warning",
      "findings": 11,
      "details": {
        "total_packages_audited": 750,
        "top_licenses": [
          {"license": "MIT License", "count": 415},
          {"license": "BSD License", "count": 96},
          {"license": "Apache Software License", "count": 56},
          {"license": "MIT", "count": 29},
          {"license": "Apache-2.0", "count": 15}
        ],
        "unknown_licenses": 11,
        "copyleft_detected": true,
        "note": "11 packages with UNKNOWN license require manual review"
      }
    },
    {
      "number": 11,
      "name": "Security Tests (pytest)",
      "tool": "pytest",
      "tool_version": "7.2.1",
      "owasp_id": "A04:2021",
      "cwe": "CWE-284",
      "status": "passed",
      "findings": 0,
      "tests_passed": 22,
      "tests_failed": 0,
      "tests_total": 22,
      "duration_seconds": 0.72,
      "groups": [
        {"name": "TestSecrets", "owasp": "A07:2021", "passed": 3, "total": 3},
        {"name": "TestInjection", "owasp": "A03:2021", "passed": 4, "total": 4},
        {"name": "TestSecurityConfig", "owasp": "A05:2021", "passed": 5, "total": 5},
        {"name": "TestCryptoTransport", "owasp": "A02:2021", "passed": 3, "total": 3},
        {"name": "TestVulnerableAppDetection", "owasp": null, "passed": 6, "total": 6},
        {"name": "TestDependencies", "owasp": "A06:2021", "passed": 1, "total": 1}
      ]
    },
    {
      "number": 12,
      "name": "Notifications (TG + Discord)",
      "tool": "curl",
      "tool_version": null,
      "owasp_id": null,
      "cwe": null,
      "status": "skipped",
      "findings": 0,
      "details": "Notifications require TELEGRAM_BOT_TOKEN and DISCORD_WEBHOOK_URL secrets. Skipped in local run."
    }
  ],
  "summary": {
    "total_findings": 28,
    "by_severity": {
      "critical": 2,
      "high": 3,
      "medium": 4,
      "warning": 15,
      "info": 4
    },
    "checks_passed": 4,
    "checks_warning": 5,
    "checks_failed": 1,
    "checks_skipped": 2,
    "owasp_coverage": {
      "A02:2021": {"name": "Cryptographic Failures", "covered": true, "tools": ["pytest"]},
      "A03:2021": {"name": "Injection", "covered": true, "tools": ["bandit", "semgrep"]},
      "A04:2021": {"name": "Insecure Design", "covered": true, "tools": ["pytest"]},
      "A05:2021": {"name": "Security Misconfiguration", "covered": true, "tools": ["hadolint", "trivy", "checkov"]},
      "A06:2021": {"name": "Vulnerable Components", "covered": true, "tools": ["safety", "pip-audit", "trivy"]},
      "A07:2021": {"name": "Auth Failures / Secrets", "covered": true, "tools": ["gitleaks", "grep"]}
    },
    "tools_used": [
      {"name": "gitleaks", "version": "8.24.3", "type": "binary"},
      {"name": "bandit", "version": "1.9.3", "type": "pip"},
      {"name": "semgrep", "version": "1.152.0", "type": "pip"},
      {"name": "safety", "version": "3.7.0", "type": "pip"},
      {"name": "pip-audit", "version": "2.9.0", "type": "pip"},
      {"name": "trivy", "version": "0.59.1", "type": "binary"},
      {"name": "hadolint", "version": "2.12.0", "type": "binary"},
      {"name": "pytest", "version": "7.2.1", "type": "pip"},
      {"name": "pip-licenses", "version": "5.5.1", "type": "pip"}
    ]
  },
  "vulnerable_app_analysis": {
    "file": "vulnerable_app/app.py",
    "intentional_vulnerabilities": 7,
    "bandit_findings_medium_plus": 6,
    "semgrep_findings": 13,
    "vulns": [
      {"id": 1, "type": "Hardcoded Secrets", "line": "27-29", "owasp": "A07:2021", "cwe": "CWE-798"},
      {"id": 2, "type": "SQL Injection", "line": 40, "owasp": "A03:2021", "cwe": "CWE-89"},
      {"id": 3, "type": "Command Injection", "line": 56, "owasp": "A03:2021", "cwe": "CWE-78"},
      {"id": 4, "type": "Insecure Deserialization", "line": 70, "owasp": "A08:2021", "cwe": "CWE-502"},
      {"id": 5, "type": "Path Traversal", "line": 80, "owasp": "A01:2021", "cwe": "CWE-22"},
      {"id": 6, "type": "SSRF", "line": 93, "owasp": "A10:2021", "cwe": "CWE-918"},
      {"id": 7, "type": "Debug Mode in Production", "line": 134, "owasp": "A05:2021", "cwe": "CWE-94"}
    ]
  }
}
